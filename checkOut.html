<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Check Out</title>

    <link href="./src/output.css" rel="stylesheet">
    <script src="//unpkg.com/alpinejs" defer></script>
</head>

<body 
x-data="{
    open: false,
    src: '',
    cart: [],
    sizeLabels: { Small: '8oz', Medium: '12oz', Large: '16oz' },

    init() {
        this.loadCart()

        window.addEventListener('storage', () => {
            this.loadCart()
        })
    },

    loadCart(){
        this.cart = JSON.parse(localStorage.getItem('cart')) || []
    },

    clearCart(){
        localStorage.removeItem('cart')
        this.cart = []
    },

    removeItem(index){
        this.cart.splice(index, 1)
        localStorage.setItem('cart', JSON.stringify(this.cart))
    }

}"
class="min-h-screen bg-no-repeat bg-cover bg-center flex flex-col items-center justify-center bg-pink-200"
style="background-image: url('img/settings_sales_ordererzxs.png');"
>


    <!-- Header --> 
    <header class="w-full flex items-center full max-w-2xl mt-3 gap-18"> 
        <!-- Logo & Name --> 
        <div class="flex items-center space-x-3 mb-[15%]"> 
            <a href="index.html"> 
                <img 
                    src="img/swirls-logo.webp" 
                    alt="Swirls Logo" 
                    class="w-12 h-12" 
                /> 
            </a> 

            <h1 class="text-2xl font-semibold text-gray-800">
                Swirls
            </h1> 
        </div>

        <div class="text-center space-y-2 mt-5"> 
            <h1 class="text-xl">
                We Serve Happiness!
            </h1> 

            <a href="index.html"> 
                <img 
                    src="img/ep_success-filled.png" 
                    alt="Swirls Logo" 
                    class="w-15 mx-auto" 
                /> 
            </a> 
            
            <h1 class="text-2xl">
                Order success, thank you!
            </h1> 
        </div> 
    </header>

    <div class="flex flex-col items-center w-full px-6">

        <h1 class="w-full max-w-5xl  mb-3 px-4">
            Order Summary
        </h1>

        <!-- Orders Box -->
        <div class="p-2 border-2 backdrop-blur-sm rounded-2xl shadow-2xl w-full max-w-5xl">

            <!-- Orders List -->
            <div class="max-h-[45vh] overflow-y-auto">

                <template x-if="cart.length === 0">
                    <p class="text-gray-500 text-center py-10">
                        No orders yet.
                    </p>
                </template>
                
                <template x-for="(item, index) in cart" :key="index">
                    <div class="flex justify-between border-b border-gray-300 px-5 py-2">

                        <!-- Left side -->
                        <div class="flex justify-between w-full text-xs border-b-1 p-2 ">
                            <div class="space-y-2">
                                <div class=" flex space-x-2">
                                    <p class="font-semibold " x-text="item.name + ' - ' "></p>
                                    <p class=""x-text="item.flavor"></p>
                                </div>
                                <div class="flex  space-x-4">
                                    <p x-text="'₱' +item.price"></p>
                                    <p x-text="item.size ? ' ' + sizeLabels[item.size] : ''"></p>
                                </div>
                                <!-- Dipped Display -->
                                <p class="text-xs "
                                    x-show="item.dipped == 1">
                                        Dipped (+₱5.00)
                                </p> 
                            </div>

                            <div class="space-y-2">
                                <p class="" x-text=" item.quantity + ' pcs '"></p>
                                <p x-text="'₱' + (Number(item.price) * Number(item.quantity)).toFixed(2)"></p>
                            </div>

                        </div>



                    </div>
                </template>

                <!-- Total -->
                <div class="flex justify-between px-5 py-5 font-bold text-xl border-t mt-4">
                    <p>Total</p>
                    <p x-text="'₱ ' + cart
                        .reduce((sum, i) => sum + Number(i.price)*Number(i.quantity), 0)
                        .toFixed(2)">
                    </p>
                </div>

            </div>
        </div>

        <!-- total and Home Button -->
        <div class="flex justify-between w-full max-w-5xl px-2 mt-2" >
            <!-- Total -->
            <div class="flex justify-between items-center text-sm font-bold
                     bg-white px-4 m-2 rounded-2xl drop-shadow-sm space-x-2">
                <h1 class=" ">Total: </h1>
                <h1 x-text="'₱ ' + cart
                    .reduce((sum, i) => sum + Number(i.price) * Number(i.quantity), 0)
                    .toFixed(2)"
                    class=" ">
                </h1>
            </div>

            <!-- Home Button -->
            <a href="index.html">
                <button>
                    <img 
                        @click="clearCart()"
                        src="buttonPic/homeBtn.png" 
                        alt="Home Button"
                        class="active:scale-95 w-[50px] h-[60px] transition"
                    >
                </button>
            </a>

            
        </div>

    </div>

</body>
</html>
